/*
Muhab Elgamal
Dealership
*/

use Dealership;
-- show tables;
select *from supplier;
-- Select * From supplier;
-- Supplier
INSERT INTO supplier VALUES(007, 'Zoro', 'Edward', '8088 Franklin Ave. Plainfield, NJ 07060', 'Motoring' ,001);
INSERT INTO supplier VALUES(365, 'Sean','Lawless', '13 Ramblewood Court Rockville Centre, NY 11570', 'AMG Boyz',002);
INSERT INTO supplier VALUES(224, 'John','Myers', '8146 Pineknoll Street West New York, NJ 07093', 'Tuned Tokyo',003);
INSERT INTO supplier VALUES(695, 'David','Wright', '7629 York Dr.Feasterville Trevose, PA 19053', 'Hoonigans' ,004);
INSERT INTO supplier VALUES(005, 'Jose','Reyes', '512 West Dr.Ponte Vedra Beach, FL 32082', 'Goon Customs', 005);
INSERT INTO supplier VALUES(422, 'Moe','Leon', '158 County St.Fayetteville, NC 28303', 'MoeMods', 006);
INSERT INTO supplier VALUES(313, 'Iziah','Thompson', '8388 Dogwood St. Attleboro, MA 02703', 'AutoDime', 007);
INSERT INTO supplier VALUES(112, 'Roger','Federer', '11 South Sierra Dr. Toms River, NJ 08753', 'Bimerclinic', 008);
INSERT INTO supplier VALUES(321, 'Roger',' Federer', '11 South Sierra Dr. Toms River, NJ 08753', 'Bimerclinic', 009);
INSERT INTO supplier VALUES(931, 'Adam','Guy', '9702 E. Hillcrest Street Vista, CA 92083', 'AutoDreamz', 010);
INSERT INTO supplier VALUES(243, 'Rachel','Adams', '212 Homestead Lane Taylors, SC 29687', 'AutoLit', 011);
INSERT INTO supplier VALUES(231, 'Nicole','Brandy', '8498 Creek Street Orchard Park, NY 14127', 'DreamZone', 012);
INSERT INTO supplier VALUES(111, 'Nick','Wilson', '7496 Valley Drive Williamsport, PA 17701', 'AutoNext', 013);
INSERT INTO supplier VALUES(115, 'Sammy','Knight', '816 Parker Ave. San Diego, CA 92111', 'AutoCart', 014);
INSERT INTO supplier VALUES(515, 'Chase','Fields', '127 Ketch Harbour St. Melbourne, FL 32904', 'BrioZone', 015);
INSERT INTO supplier VALUES(324, 'Adam','Guess', '835 Meadow Street Canton, GA 30114', 'YotaClinic', 016);
INSERT INTO supplier VALUES(325, 'Adam','Guess', '835 Meadow Street Canton, GA 30114', 'YotaClinic', 017);
INSERT INTO supplier VALUES(326, 'Adam','Guess', '835 Meadow Street Canton, GA 30114', 'YotaClinic', 018);
INSERT INTO supplier VALUES(327, 'Adam','Guess', '835 Meadow Street Canton, GA 30114', 'YotaClinic', 019);
INSERT INTO supplier VALUES(328, 'Adam','Guess', '835 Meadow Street Canton, GA 30114', 'YotaClinic', 020);
INSERT INTO supplier VALUES(542, 'Mike','Golden', '932 Sussex Street Wayne, NJ 07470', 'LexExpress', 021);
INSERT INTO supplier VALUES(543, 'Mike','Golden', '932 Sussex Street Wayne, NJ 07470', 'LexExpress', 022);
INSERT INTO supplier VALUES(544, 'Mike','Golden', '932 Sussex Street Wayne, NJ 07470', 'LexExpress', 023);
INSERT INTO supplier VALUES(545, 'Mike','Golden', '932 Sussex Street Wayne, NJ 07470', 'LexExpress', 024);
INSERT INTO supplier VALUES(546, 'Mike','Golden', '932 Sussex Street Wayne, NJ 07470', 'LexExpress', 025);
INSERT INTO supplier VALUES(624, 'Austin','Powers', '7B Hilltop Street Mahwah, NJ 07430', 'AudiWorld', 026);
INSERT INTO supplier VALUES(625, 'Austin','Powers', '7B Hilltop Street Mahwah, NJ 07430', 'AudiWorld', 027);
INSERT INTO supplier VALUES(626, 'Austin','Powers', '7B Hilltop Street Mahwah, NJ 07430', 'AudiWorld', 028);
INSERT INTO supplier VALUES(627, 'Austin','Powers', '7B Hilltop Street Mahwah, NJ 07430', 'AudiWorld', 029);
INSERT INTO supplier VALUES(628, 'Austin','Powers', '7B Hilltop Street Mahwah, NJ 07430', 'AudiWorld', 030);
INSERT INTO supplier VALUES(942, 'Julia','Jordan', '17 Orchard Court Elmhurst, NY 11373', 'NissanBang', 031);
INSERT INTO supplier VALUES(943, 'Julia','Jordan', '17 Orchard Court Elmhurst, NY 11373', 'NissanBang', 032);
INSERT INTO supplier VALUES(944, 'Julia','Jordan', '17 Orchard Court Elmhurst, NY 11373', 'NissanBang', 033);
INSERT INTO supplier VALUES(945, 'Julia','Jordan', '17 Orchard Court Elmhurst, NY 11373', 'NissanBang', 034);
INSERT INTO supplier VALUES(946, 'Julia','Jordan', '17 Orchard Court Elmhurst, NY 11373', 'NissanBang', 035);
INSERT INTO supplier VALUES(020, 'Jordan','James', '37 Courtland Lane Tewksbury, MA 01876', 'CadiWorld', 036);
INSERT INTO supplier VALUES(021, 'Jordan','James', '37 Courtland Lane Tewksbury, MA 01876', 'CadiWorld', 037);
INSERT INTO supplier VALUES(022, 'Jordan','James', '37 Courtland Lane Tewksbury, MA 01876', 'CadiWorld', 038);
INSERT INTO supplier VALUES(023, 'Jordan','James', '37 Courtland Lane Tewksbury, MA 01876', 'CadiWorld', 039);
INSERT INTO supplier VALUES(024, 'Jordan','James', '37 Courtland Lane Tewksbury, MA 01876', 'CadiWorld', 040);
INSERT INTO supplier VALUES(461, 'Justin','Matthews', '747 Brook St. Torrance, CA 90505', 'DodgeZone', 041);
INSERT INTO supplier VALUES(462, 'Justin','Matthews', '747 Brook St. Torrance, CA 90505', 'DodgeZone', 042);
INSERT INTO supplier VALUES(463, 'Justin','Matthews', '747 Brook St. Torrance, CA 90505', 'DodgeZone', 043);
INSERT INTO supplier VALUES(464, 'Justin','Matthews', '747 Brook St. Torrance, CA 90505', 'DodgeZone', 044);
INSERT INTO supplier VALUES(465, 'Justin','Matthews', '747 Brook St. Torrance, CA 90505', 'DodgeZone', 045);
INSERT INTO supplier VALUES(074, 'Ashley','Rose', '8868 E. Brown St. Shirley, NY 11967', 'FordGang', 046);
INSERT INTO supplier VALUES(075, 'Ashley','Rose', '8868 E. Brown St. Shirley, NY 11967', 'FordGang', 047);
INSERT INTO supplier VALUES(076, 'Ashley','Rose', '8868 E. Brown St. Shirley, NY 11967', 'FordGang', 048);
INSERT INTO supplier VALUES(077, 'Ashley','Rose', '8868 E. Brown St. Shirley, NY 11967', 'FordGang', 049);
INSERT INTO supplier VALUES(078, 'Ashley','Rose', '8868 E. Brown St. Shirley, NY 11967', 'FordGang', 050);
INSERT INTO supplier VALUES(858, 'Austin','Powers', '52 Elizabeth St. Prior Lake, MN 55372', 'BenzBoyz', 051);
INSERT INTO supplier VALUES(859, 'Austin','Powers', '52 Elizabeth St. Prior Lake, MN 55372', 'BenzBoyz', 052);
INSERT INTO supplier VALUES(860, 'Austin','Powers', '52 Elizabeth St. Prior Lake, MN 55372', 'BenzBoyz', 053);
INSERT INTO supplier VALUES(861, 'Austin','Powers', '52 Elizabeth St. Prior Lake, MN 55372', 'BenzBoyz', 054);
INSERT INTO supplier VALUES(862, 'Austin','Powers', '52 Elizabeth St. Prior Lake, MN 55372', 'BenzBoyz', 055);
INSERT INTO supplier VALUES(602, 'Shea','Adams', '8305 Stillwater St. Strongsville, OH 44136', 'RondasHondas', 056);
INSERT INTO supplier VALUES(603, 'Shea','Adams', '8305 Stillwater St. Strongsville, OH 44136', 'RondasHondas', 057);
INSERT INTO supplier VALUES(604, 'Shea','Adams', '8305 Stillwater St. Strongsville, OH 44136', 'RondasHondas', 058);
INSERT INTO supplier VALUES(605, 'Shea','Adams', '8305 Stillwater St. Strongsville, OH 44136', 'RondasHondas', 059);
INSERT INTO supplier VALUES(606, 'Shea','Adams', '8305 Stillwater St. Strongsville, OH 44136', 'RondasHondas', 060);
INSERT INTO supplier VALUES(498, 'Henry','Hunter', '653 West Jennings St. Charlotte, NC 28205', 'WagonAuto', 061);
INSERT INTO supplier VALUES(499, 'Henry','Hunter', '653 West Jennings St. Charlotte, NC 28205', 'WagonAuto', 062);
INSERT INTO supplier VALUES(500, 'Henry','Hunter', '653 West Jennings St. Charlotte, NC 28205', 'WagonAuto', 063);
INSERT INTO supplier VALUES(501, 'Henry','Hunter', '653 West Jennings St. Charlotte, NC 28205', 'WagonAuto', 064);
INSERT INTO supplier VALUES(502, 'Henry','Hunter', '653 West Jennings St. Charlotte, NC 28205', 'WagonAuto', 065);

-- Delete from supplier where idsupplier = 324;
-- SELECT * FROM Model;
-- Model

-- Select * FROM Buyer;
-- DELETE FROM buyer WHERE idbuyer = 42;
-- Buyer
INSERT INTO buyer VALUES(42, 001, 'Rebecca', '322 Livingston St. West Deptford, NJ 08096', '5-12-2001', 'Lease', 4000);
INSERT INTO buyer VALUES(101, 003, 'Luffy', '8757 West Cross Dr.New Haven, CT 06511', '3-18-2020', 'Finance', 70000);
INSERT INTO buyer VALUES(102, 004,  'Ussop', '94 Pin Oak St.San Angelo, TX 76901', '01-08-2018', 'Finance', 20000);
INSERT INTO buyer VALUES(24, 006, 'Ace', '9204 Bridgeton Lane Bristol, CT 06010', '02-12-2021', 'Finance', 800000);
INSERT INTO buyer VALUES(2, 007, 'Robin', '84 Glen Eagles Drive Orchard Park, NY 14127', '08-24-2018', 'Finance', 60000); 
INSERT INTO buyer VALUES(75, 008, 'Valdet', '8723 Fordham St. Freeport, NY 11520', '07-11-2014', 'Lease', 45000);
INSERT INTO buyer VALUES(35, 010, 'Sanji', '53 Sycamore St. Uniontown, PA 15401', '09-10-2020', 'Lease', 95000);

SELECT * FROM CARS;
 -- DELETE FROM cars WHERE idcar = 021;
-- Cars
INSERT INTO cars VALUES(001, 'Red', 'BMW', '330xi', 2003, 'Used', '10-25-2000', 76324, 2, 0, 4000);
INSERT INTO cars VALUES(002, 'Midnight Green', 'Mercedes', 'GT', 2021, 'New', '01-01-2021', 0, 0, 0, 100000);
INSERT INTO cars VALUES(003, 'Blood Orange', 'Nissan', 'GTR', 2018, 'Used',  '01-01-2020',1232, 1, 0, 75000);
INSERT INTO cars VALUES(004, 'Blue', 'Volkswagen', 'GTI', 2014, 'Used', '03-22-2017',123454, 5, 1, 28000);
INSERT INTO cars VALUES(005, 'Yellow', 'Acura', 'TL Type R', 2007, 'Used', '03-5-2018', 111232, 6, 0, 30000);
INSERT INTO cars VALUES(006, 'Red', 'Ferrari', 'LaFerrari', 2020, 'New', '02-23-2020', 0, 0, 0, 1000000);
INSERT INTO cars VALUES(007, 'Purple', 'McLaren', '720s', 2018, 'New', '01-12-2018', 0, 0, 0, 90000);
INSERT INTO cars VALUES(008, 'Baby Blue', 'BMW', 'M3', 2006, 'Used', '02-15-2010', 24545, 3,0,45000);
INSERT INTO cars VALUES(009, 'Black', 'BMW', 'M6', 2016, 'Used', '06-20-2018', 5321, 2,0, 65000);
INSERT INTO cars VALUES(010, 'White', 'Acura', 'NSX', 2019, 'Used', '03-15-2019', 524, 0, 0, 95000);
INSERT INTO cars VALUES(011, 'Orange', 'BMW', '335i', 2006, 'Used', '8-05-2004', 56324, 2, 0, 10000);
INSERT INTO cars VALUES(012, 'Grey', 'BMW', 'M8', 2021, 'New', '8-05-2021', 0, 0, 0, 55000);
INSERT INTO cars VALUES(013, 'Grey', 'Acura', 'TLX', 20020, 'New', '7-05-2021', 0, 0, 0, 35000);
INSERT INTO cars VALUES(014, 'Red', 'Acura', 'MDX', 2009, 'Used', '7-05-2013', 56453, 4, 1, 15000);
INSERT INTO cars VALUES(015, 'White', 'Acura', 'RL', 2009, 'Used', '2-24-2015', 15353, 1, 0, 9000);
INSERT INTO cars VALUES(016, 'White', 'Toyota', 'Camry', 2021, 'New', '2-25-2021', 0, 0, 0, 35000);
INSERT INTO cars VALUES(017, 'Black', 'Toyota', 'Prius', 2021, 'New', '3-30-2021', 0, 0, 0, 45000);
INSERT INTO cars VALUES(018, 'Black', 'Toyota', 'Tundra', 2021, 'New', '6-30-2021', 0, 0, 0, 65000);
INSERT INTO cars VALUES(019, 'Red', 'Toyota', 'Tacoma', 2010, 'Used', '6-30-2008', 154000, 4, 0, 45000);
INSERT INTO cars VALUES(020, 'Green', 'Toyota', 'Camry', 2009, 'Used', '2-12-20012', 254000, 6, 0, 5000);
INSERT INTO cars VALUES(021, 'Green', 'Lexus', 'IS', 2021, 'New', '2-12-2021', 0, 0, 0, 45000);
INSERT INTO cars VALUES(022, 'White', 'Lexus', 'ES', 2021, 'New', '4-23-2021', 0, 0, 0, 55000);
INSERT INTO cars VALUES(023, 'White', 'Lexus', 'LS 430', 2003, 'Used', '10-23-2012', 145321, 6, 0, 4000);
INSERT INTO cars VALUES(024, 'Blue', 'Lexus', 'RC', 2019, 'New', '10-23-2020', 125, 0, 0, 34000);
INSERT INTO cars VALUES(025, 'Blue', 'Lexus', 'RX', 2016, 'Used', '10-23-2020', 1024, 1, 0, 44000);
INSERT INTO cars VALUES(026, 'Blue', 'Audi', 'RS5', 2021, 'New', '10-23-2021', 0, 0, 0, 64000);
INSERT INTO cars VALUES(027, 'White', 'Audi', 'A4', 2012, 'Used', '12-04-2015', 102645, 3, 0, 24000);
INSERT INTO cars VALUES(028, 'Black', 'Audi', 'A6', 2018, 'Used', '8-24-2019', 2645, 1, 0, 54000);
INSERT INTO cars VALUES(029, 'Grey', 'Audi', 'A3', 2020, 'New', '3-12-2020', 1045, 0, 0, 43000);
INSERT INTO cars VALUES(030, 'Grey', 'Audi', 'S4', 2020, 'New', '7-02-2020', 104, 0, 0, 53000);
INSERT INTO cars VALUES(031, 'Blood Orange', 'Nissan', '350z', 2006, 'Used',  '01-01-2018',765400, 3, 0, 6000);
INSERT INTO cars VALUES(032, 'Black', 'Nissan', 'Maxima', 2021, 'New',  '01-01-2021',456, 0, 0, 26000);
INSERT INTO cars VALUES(033, 'Black', 'Nissan', '370z Nismo', 2021, 'New',  '01-01-2021',0, 0, 0, 46000);
INSERT INTO cars VALUES(034, 'Grey', 'Nissan', 'Pathfinder', 2006, 'Used',  '08-06-2016',187450, 4, 1, 7500);
INSERT INTO cars VALUES(035, 'Blue', 'Nissan', 'Altima', 2008, 'Used',  '03-06-2012',127450, 2, 0, 6500);
INSERT INTO cars VALUES(036, 'Black', 'Cadillac', 'CT4 sport', 2021, 'New',  '03-06-2021',0, 0, 0, 35000);
INSERT INTO cars VALUES(037, 'White', 'Cadillac', 'XT5', 2022, 'New',  '08-06-2021',0, 0, 0, 45000);
INSERT INTO cars VALUES(038, 'White', 'Cadillac', 'Escalade', 2022, 'New',  '08-06-2021',0, 0, 0, 55000);
INSERT INTO cars VALUES(039, 'Red', 'Cadillac', 'DeVille', 1998, 'Used',  '03-24-2002',154434, 2, 0, 55000);
INSERT INTO cars VALUES(040, 'Green', 'Cadillac', 'STS', 2005, 'Used',  '11-24-2008',194434, 6, 0, 5000);
INSERT INTO cars VALUES(041, 'Green', 'Dodge', 'Charger', 2021, 'New',  '07-02-2021',0, 0, 0, 45000);
INSERT INTO cars VALUES(042, 'Red', 'Dodge', 'Challenger', 2021, 'New',  '07-02-2021',0, 0, 0, 55000);
INSERT INTO cars VALUES(043, 'White', 'Dodge', 'Durango', 2021, 'New',  '05-14-2021',0, 0, 0, 35000);
INSERT INTO cars VALUES(044, 'White', 'Dodge', 'Charger', 2015, 'Used',  '02-25-2018',45645, 1, 0, 15000);
INSERT INTO cars VALUES(045, 'Grey', 'Dodge', 'Challanger', 2016, 'Used',  '02-25-2018',55645, 2, 0, 15000);
INSERT INTO cars VALUES(046, 'White', 'Ford', 'Mustang', 2021, 'New',  '08-11-2021',0, 0, 0, 35000);
INSERT INTO cars VALUES(047, 'Black', 'Ford', 'Bronco', 2021, 'New',  '08-11-2021',0, 0, 0, 55000);
INSERT INTO cars VALUES(048, 'Green', 'Ford', 'Escape', 2021, 'New',  '09-25-2021',0, 0, 0, 28000);
INSERT INTO cars VALUES(049, 'Green', 'Ford', 'Mustang', 2016, 'Used',  '09-25-2021',164211, 2, 0, 8000);
INSERT INTO cars VALUES(050, 'White', 'Ford', 'Thunderbird', 2002, 'Used',  '09-25-2005',124211, 3, 0, 10000);
INSERT INTO cars VALUES(051, 'Red', 'Mercedes-Benz', 'C63 AMG', 2008, 'Used',  '09-25-2010',124211, 3, 0, 38000);
INSERT INTO cars VALUES(052, 'White', 'Mercedes-Benz', 'G63 AMG', 2021, 'New',  '09-25-2021',0, 0, 0, 58000);
INSERT INTO cars VALUES(053, 'Black', 'Mercedes-Benz', 'G Wagon', 2021, 'New',  '06-24-2021',0, 0, 0, 78000);
INSERT INTO cars VALUES(054, 'Grey', 'Mercedes-Benz', 'E350', 2021, 'New',  '07-24-2021',0, 0, 0, 46000);
INSERT INTO cars VALUES(055, 'Blue', 'Mercedes-Benz', 'C250', 2015, 'Used',  '03-12-2018',60475, 2, 0, 18000);
INSERT INTO cars VALUES(056, 'Green', 'Honda', 'Civic Type-R', 2021, 'New',  '05-12-2021',0, 0, 0, 48000);
INSERT INTO cars VALUES(057, 'Black', 'Honda', 'Civic', 2021, 'New',  '07-24-2021',0, 0, 0, 28000);
INSERT INTO cars VALUES(058, 'Red', 'Honda', 'Accord', 2022, 'New',  '08-24-2022',0, 0, 0, 38000);
INSERT INTO cars VALUES(059, 'Green', 'Honda', 'Civic', 2006, 'Used',  '02-21-2012',123451, 0, 0, 8000);
INSERT INTO cars VALUES(060, 'Green', 'Honda', 'CRV', 2006, 'Used',  '01-24-2009',183451, 0, 0, 5000);
INSERT INTO cars VALUES(061, 'Blue', 'Volkswagen', 'Golf', 2022, 'New',  '05-24-2022',0, 0, 0, 25000);
INSERT INTO cars VALUES(062, 'White', 'Volkswagen', 'Jetta', 2022, 'New',  '08-12-2022',0, 0, 0, 35000);
INSERT INTO cars VALUES(063, 'Grey', 'Volkswagen', 'Tiguan', 2022, 'New',  '08-12-2022',0, 0, 0, 45000);
INSERT INTO cars VALUES(064, 'Black', 'Volkswagen', 'CC', 2012, 'Used',  '04-24-2016',132564, 4, 2, 5000);
INSERT INTO cars VALUES(065, 'Green', 'Volkswagen', 'Beetle', 2009, 'Used',  '04-24-2016',95357, 2, 0, 8000);

-- Car has Supplier
INSERT INTO cars_has_supplier VALUES(001, 007);
INSERT INTO cars_has_supplier VALUES(002, 365);
INSERT INTO cars_has_supplier VALUES(003, 224);
INSERT INTO cars_has_supplier VALUES(004, 695);
INSERT INTO cars_has_supplier VALUES(005, 005);
INSERT INTO cars_has_supplier VALUES(006, 422);
INSERT INTO cars_has_supplier VALUES(007, 313);
INSERT INTO cars_has_supplier VALUES(008, 112);
INSERT INTO cars_has_supplier VALUES(009, 321);
INSERT INTO cars_has_supplier VALUES(010, 931);
INSERT INTO cars_has_supplier VALUES(011, 243);
INSERT INTO cars_has_supplier VALUES(012, 231);
INSERT INTO cars_has_supplier VALUES(013, 111);
INSERT INTO cars_has_supplier VALUES(014, 115);
INSERT INTO cars_has_supplier VALUES(015, 515);
INSERT INTO cars_has_supplier VALUES(016, 324);
INSERT INTO cars_has_supplier VALUES(017, 325);
INSERT INTO cars_has_supplier VALUES(018, 326);
INSERT INTO cars_has_supplier VALUES(019, 327);
INSERT INTO cars_has_supplier VALUES(020, 328);
INSERT INTO cars_has_supplier VALUES(021, 542);
INSERT INTO cars_has_supplier VALUES(022, 543);
INSERT INTO cars_has_supplier VALUES(023, 544);
INSERT INTO cars_has_supplier VALUES(024, 545);
INSERT INTO cars_has_supplier VALUES(025, 546);
INSERT INTO cars_has_supplier VALUES(026, 624);
INSERT INTO cars_has_supplier VALUES(027, 625);
INSERT INTO cars_has_supplier VALUES(028, 626);
INSERT INTO cars_has_supplier VALUES(029, 627);
INSERT INTO cars_has_supplier VALUES(030, 628);
INSERT INTO cars_has_supplier VALUES(031, 942);
INSERT INTO cars_has_supplier VALUES(032, 943);
INSERT INTO cars_has_supplier VALUES(033, 944);
INSERT INTO cars_has_supplier VALUES(034, 945);
INSERT INTO cars_has_supplier VALUES(035, 946);
INSERT INTO cars_has_supplier VALUES(036, 020);
INSERT INTO cars_has_supplier VALUES(037, 021);
INSERT INTO cars_has_supplier VALUES(038, 022);
INSERT INTO cars_has_supplier VALUES(039, 023);
INSERT INTO cars_has_supplier VALUES(040, 024);
INSERT INTO cars_has_supplier VALUES(041, 461);
INSERT INTO cars_has_supplier VALUES(042, 462);
INSERT INTO cars_has_supplier VALUES(043, 463);
INSERT INTO cars_has_supplier VALUES(044, 464);
INSERT INTO cars_has_supplier VALUES(045, 465);
INSERT INTO cars_has_supplier VALUES(046, 074);
INSERT INTO cars_has_supplier VALUES(047, 075);
INSERT INTO cars_has_supplier VALUES(048, 076);
INSERT INTO cars_has_supplier VALUES(049, 077);
INSERT INTO cars_has_supplier VALUES(050, 078);
INSERT INTO cars_has_supplier VALUES(051, 858);
INSERT INTO cars_has_supplier VALUES(052, 859);
INSERT INTO cars_has_supplier VALUES(053, 860);
INSERT INTO cars_has_supplier VALUES(054, 861);
INSERT INTO cars_has_supplier VALUES(055, 862);
INSERT INTO cars_has_supplier VALUES(056, 602);
INSERT INTO cars_has_supplier VALUES(057, 603);
INSERT INTO cars_has_supplier VALUES(058, 604);
INSERT INTO cars_has_supplier VALUES(059, 605);
INSERT INTO cars_has_supplier VALUES(060, 606);
INSERT INTO cars_has_supplier VALUES(061, 498);
INSERT INTO cars_has_supplier VALUES(062, 499);
INSERT INTO cars_has_supplier VALUES(063, 500);
INSERT INTO cars_has_supplier VALUES(064, 501);
INSERT INTO cars_has_supplier VALUES(065, 502);

-- Car has Model

-- SELECT * FROM dealer_services;
-- Car Services 
INSERT INTO dealer_services VALUES(001, 42, 18, 75324, 85546, 75324, 45569, 25456, 42, 001);
INSERT INTO dealer_services VALUES(002, null, 1, null, 4000, null, null, null, null, 002);
INSERT INTO dealer_services VALUES(003, 101, 6, 21322, 25768, 22435, 21322, null, 101, 003);
INSERT INTO dealer_services VALUES(004, 102, 16, 56043, 65876, 43576, 35756, 47847, 102,004);
INSERT INTO dealer_services VALUES(005, null, 14, 52345, 75124, 42154, 45214, 35457, 35457, 005);
INSERT INTO dealer_services VALUES(006, 24, 0, null, null, null, null, null, null, 006);
INSERT INTO dealer_services VALUES(007, 2 , 0, 7563, null, null, null, null, 2, 007);
INSERT INTO dealer_services VALUES(008, 75 , 3, 26435, 15342, 15342, 15213, 16223, 75, 008);
INSERT INTO dealer_services VALUES(009, null, 3, null, 12364, null, null, null, null, 009);
INSERT INTO dealer_services VALUES(010, 35, 0, null, null, null, null, null, null, 010);
INSERT INTO dealer_services VALUES(011, null, 14, null, 52324, null, null, null, null, 011);
INSERT INTO dealer_services VALUES(012, null, 0, null, null, null, null, null, null, 012);
INSERT INTO dealer_services VALUES(013, null, 0, null, null, null, null, null, null, 013);
INSERT INTO dealer_services VALUES(014, null, 14, 25412, 56250, 25412, 25412, 25412, 25412, 014);
INSERT INTO dealer_services VALUES(015, null, 0, null, null, null, null, null, null, 015);
INSERT INTO dealer_services VALUES(016, null, 0, null, null, null, null, null, null, 016);
INSERT INTO dealer_services VALUES(017, null, 0, null, null, null, null, null, null, 017);
INSERT INTO dealer_services VALUES(018, null, 0, null, null, null, null, null, null, 018);
INSERT INTO dealer_services VALUES(019, null, 38, 102425, 151000, 102425, 102425, 102425, 102425, 019);
INSERT INTO dealer_services VALUES(020, null, 63, 152425, 251000, 152425, 152425, 152425, 152425, 020);
INSERT INTO dealer_services VALUES(021, null, 0, null, null, null, null, null, null, 021);
INSERT INTO dealer_services VALUES(022, null, 0, null, null, null, null, null, null, 022);
INSERT INTO dealer_services VALUES(023, null, 36, 84652, 142024, 84652, 84652, 84652, 84652, 022);
INSERT INTO dealer_services VALUES(024, null, 0, null, null, null, null, null, null, 024);
INSERT INTO dealer_services VALUES(025, null, 0, null, null, null, null, null, null, 025);
INSERT INTO dealer_services VALUES(026, null, 0, null, null, null, null, null, null, 026);
INSERT INTO dealer_services VALUES(027, null, 25, 102645, 98645, 102645, 102645, 102645, 102645, 026);
INSERT INTO dealer_services VALUES(028, null, 0, null, null, null, null, null, null, 028);
INSERT INTO dealer_services VALUES(029, null, 0, null, null, null, null, null, null, 029);
INSERT INTO dealer_services VALUES(030, null, 0, null, null, null, null, null, null, 030);
INSERT INTO dealer_services VALUES(031, null, 19, 74545, 73545, 74545, 74545, 74545, 74545, 031);
INSERT INTO dealer_services VALUES(032, null, 0, null, null, null, null, null, null, 032);
INSERT INTO dealer_services VALUES(033, null, 0, null, null, null, null, null, null, 033);
INSERT INTO dealer_services VALUES(034, null, 46, 112456, 184000, 112456,112456, 112456, 112456, 034);
INSERT INTO dealer_services VALUES(035, null, 38, 112456, 124000, 112456,112456, 112456, 112456, 035);
INSERT INTO dealer_services VALUES(036, null, 0, null, null, null, null, null, null, 036);
INSERT INTO dealer_services VALUES(037, null, 0, null, null, null, null, null, null, 037);
INSERT INTO dealer_services VALUES(038, null, 0, null, null, null, null, null, null, 038);
INSERT INTO dealer_services VALUES(039, null, 38, 132456, 152000, 132456,132456, 132456, 132456, 039);
INSERT INTO dealer_services VALUES(040, null, 45, 164456, 192000, 164456,164456, 164456, 164456, 040);
INSERT INTO dealer_services VALUES(041, null, 0, null, null, null, null, null, null, 041);
INSERT INTO dealer_services VALUES(042, null, 0, null, null, null, null, null, null, 042);
INSERT INTO dealer_services VALUES(043, null, 0, null, null, null, null, null, null, 043);
INSERT INTO dealer_services VALUES(044, null, 11, null, 44500, null, null, null, null, 044);
INSERT INTO dealer_services VALUES(045, null, 14, null, 54500, null, null, null, null, 045);
INSERT INTO dealer_services VALUES(046, null, 0, null, null, null, null, null, null, 046);
INSERT INTO dealer_services VALUES(047, null, 0, null, null, null, null, null, null, 047);
INSERT INTO dealer_services VALUES(048, null, 0, null, null, null, null, null, null, 048);
INSERT INTO dealer_services VALUES(049, null, 42, 125400, 163542, 125400, 125400, 125400, 125400, 049);
INSERT INTO dealer_services VALUES(050, null, 35, 98540, 123542, 98540, 98540, 98540, 98540, 050);
INSERT INTO dealer_services VALUES(051, null, 35, 98540, 123542, 98540, 98540, 98540, 98540, 051);
INSERT INTO dealer_services VALUES(052, null, 0, null, null, null, null, null, null, 052);
INSERT INTO dealer_services VALUES(053, null, 0, null, null, null, null, null, null, 053);
INSERT INTO dealer_services VALUES(054, null, 0, null, null, null, null, null, null, 054);
INSERT INTO dealer_services VALUES(055, null, 15, null, 60000, null, null, null, null, 055);
INSERT INTO dealer_services VALUES(056, null, 0, null, null, null, null, null, null, 056);
INSERT INTO dealer_services VALUES(057, null, 0, null, null, null, null, null, null, 057);
INSERT INTO dealer_services VALUES(058, null, 0, null, null, null, null, null, null, 058);
INSERT INTO dealer_services VALUES(059, null, 35, 98540, 123542, 98540, 98540, 98540, 98540, 059);
INSERT INTO dealer_services VALUES(060, null, 45, 148540, 183542, 148540, 148540, 148540, 148540, 059);
INSERT INTO dealer_services VALUES(061, null, 0, null, null, null, null, null, null, 061);
INSERT INTO dealer_services VALUES(062, null, 0, null, null, null, null, null, null, 062);
INSERT INTO dealer_services VALUES(063, null, 0, null, null, null, null, null, null, 063);
INSERT INTO dealer_services VALUES(064, null, 33, 101564, 131546, 101564, 101564, 101564, 101564, 064);
INSERT INTO dealer_services VALUES(065, null, 24, null, 95464, null, null, null, null, 065);

Select * From cars where CarCondition = 'new';
select * from supplier;
select * from model;
select * from cars;
select * from dealer_services;
select * from buyer;

-- Simple Quary 1 (Shows all Suppliers and price paid by dealer to supplier)
SELECT DISTINCT supplier_name, Price_paid
FROM supplier 
WHERE idSupplier IN (
SELECT idSupplier FROM Supplier)
ORDER BY Price_paid;

-- simple Quary 2 (Returns all payments and the date they were paid on)
SELECT buyer_name,Payment_date, price_paid
FROM buyer
WHERE Price_paid <
(SELECT AVG(price)
FROM cars
WHERE price_paid > 0);

-- simple Quary 3 (Shows cars id, make, and shows its price)
SELECT idCar, make, MAX(Price) 
FROM Cars
WHERE price > 0
GROUP BY idCar;

-- simple Quary 4 (Shows Buyers name, Addresses, and if they financed or leased)
SELECT buyer_name, buyer_Address, Finance_or_lease
FROM buyer
WHERE (Buyer_Address) NOT IN (
SELECT Buyer_Address
FROM buyer
GROUP BY buyer_name
HAVING COUNT(*) > 1);

-- simple Quary 5 (updates buyers address)
SELECT * FROM buyer WHERE idBuyer = 42;

UPDATE buyer
SET Buyer_Address = '493 Canterbury St. Elmhurst, NY 11373'
WHERE idBuyer = 42;

SELECT * FROM buyer WHERE idBuyer = 42;

-- simple Quary 6 (Tells Buyer by id had how many oil Changes and also when their last oil Change)
SELECT idBuyer, Number_of_Oil_Changes, Last_Oil_Change_Miles AS LastOilChange
FROM dealer_services 
JOIN cars ON cars.idCar 
GROUP BY idBuyer
ORDER BY idBuyer DESC;

-- simple Quary 7(Shows all price paid by buyers and sums up total for last column)
SELECT idCar, SUM(Price_paid) AS Total_Revenue
FROM buyer
GROUP BY Price_Paid with Rollup;

-- Complex Quary 1 (changes the oil change and number of oil changes for car 6, also updates the buyers address for the car)
select * from dealer_services where idBuyer = 24;
SELECT * FROM Buyer WHERE idBuyer = 24;

drop procedure if exists test1; 

DELIMITER //

CREATE PROCEDURE test1()
BEGIN
DECLARE sqlerr tinyint DEFAULT FALSE;

DECLARE CONTINUE HANDLER for SQLEXCEPTION SET sqlerr = TRUE;

START TRANSACTION;
UPDATE dealer_services SET Last_Oil_Change_Miles = 3941 WHERE idCar = 006;
UPDATE dealer_services SET Number_of_oil_changes = 1 WHERE idCar = 006;
UPDATE Buyer SET Buyer_Address = '255 Oak Meadow Street Ridgewood, NJ 07450' WHERE idBuyer = 24;

IF sqlerr = FALSE THEN 
COMMIT;
SELECT 'TRANSACTION COMITTED' as msg;

else
ROLLBACK;

SELECT 'TRANSACTION ROLLBACKED DUE TO AN ERROR' AS msg;
END IF;

END//
DELIMITER ;

CALL test1();

-- Complex Quary 2 (tells the count of cars exceeding the cost of 50000)
drop procedure if exists test2;  

DELIMITER //

CREATE PROCEDURE test2()
BEGIN
	DECLARE top_count_var int;
	SELECT count(idCar) 
	INTO top_count_var
	FROM Cars
	WHERE Price >= 50000;
	IF top_count_var > 0 then
		SELECT concat(top_count_var + 1,' Car(s) exceed $50000') as message;
	ELSE
		SELECT 'No cars exceed $50000' as message;
	END IF;
END//

DELIMITER ;

CALL test2();

-- Complex Quary 3 (Deletes the dealer services for buyer with id = 42)

SELECT * FROM dealer_services;

drop procedure if exists test3;
 
DELIMITER //

CREATE PROCEDURE test3()
BEGIN
DECLARE sqlerr tinyint DEFAULT FALSE;

DECLARE CONTINUE HANDLER FOR SQLEXCEPTION SET sqlerr = true;
START TRANSACTION;

DELETE FROM dealer_services WHERE idBUyer = 42;

IF sqlerr = FALSE THEN
COMMIT;

SELECT 'Transaction Comitted' as msg;
ELSE
ROLLBACK;
SELECT 'Transaction rollbacked due to an error' as msg;
END IF;
END // 

DELIMITER ;

call test3();

SELECT * FROM dealer_services;

-- Complex Quary 4 ( creates an event to add car information to car_audit list )

SET GLOBAL event_scheduler = ON;
DROP TABLE car_audit;

CREATE TABLE car_audit
(
  idCar          INT             NOT NULL,
  Make	         VARCHAR(50)     NOT NULL,
  Model			 VARCHAR(50)	 NOT NULL,
  Price	         DECIMAL(9,2)    NOT NULL,
  Availability   VARCHAR(50)     NOT NULL,
  Date_issued    VARCHAR(50)     NOT NULL
);

DROP TRIGGER IF EXISTS minute_test;

DELIMITER //

CREATE EVENT minute_test
  ON SCHEDULE EVERY 1 MINUTE
DO BEGIN
    INSERT INTO car_audit VALUES
    (124, 'BMW', 'M8', 69999.99, 
    'YES', '11-13-2018');
END//

DELIMITER ;

SHOW EVENTS IN dealership LIKE 'min%';

SELECT * FROM car_audit;

-- Clean up
DELETE FROM car_audit;
DROP EVENT  minute_test;

-- Complex Quary 5 (Changes number of accidents for car with id 4)
SELECT * FROM cars WHERE idCar = 4;

DROP PROCEDURE IF EXISTS test5;

DELIMITER //

CREATE PROCEDURE test5()
BEGIN	
	-- declare error var
	DECLARE null_value 	TINYINT		DEFAULT FALSE;
	-- create conditions for error
	DECLARE CONTINUE HANDLER FOR 1048
		SET null_value = TRUE;
	
	-- try to update value	
	UPDATE cars
	SET Number_of_accidents = 2
	WHERE idCar = 4;
	-- create and display message
	IF null_value = TRUE then
		SELECT 'Row was not updated - column cannot be null.' AS message;
	ELSE
		SELECT '1 row was updated' AS message;
	END IF;	
END //

DELIMITER ;

CALL test5();

SELECT * FROM cars WHERE idCar = 4;